(function(I,N,A,y,r,U,v,b,p,o,k){"use strict";const{ScrollView:C}=U.General,{FormSection:S,FormRow:u,FormSwitchRow:w}=U.Forms;function V(){return k.useProxy(o.storage),r.React.createElement(C,null,r.React.createElement(S,{title:"Settings"},r.React.createElement(w,{label:"Enable profile effects",subLabel:"If enabled, profile effects will load up.",leading:r.React.createElement(u.Icon,{source:v.getAssetIDByName("settings")}),value:o.storage.sw_effects,onValueChange:function(t){return o.storage.sw_effects=t}}),r.React.createElement(w,{label:"Enable profile themes",subLabel:"If enabled, profile themes will load up.",leading:r.React.createElement(u.Icon,{source:v.getAssetIDByName("settings")}),value:o.storage.sw_themes,onValueChange:function(t){return o.storage.sw_themes=t}}),r.React.createElement(w,{label:"Enable profile avatar decoration",subLabel:"If enabled, profile avatar decoration will load up.",leading:r.React.createElement(u.Icon,{source:v.getAssetIDByName("settings")}),value:o.storage.sw_decorations,onValueChange:function(t){return o.storage.sw_decorations=t}}),r.React.createElement(w,{label:"Enable profile banners",subLabel:"If enabled, profile effects will load up.",leading:r.React.createElement(u.Icon,{source:v.getAssetIDByName("settings")}),value:o.storage.sw_banners,onValueChange:function(t){return o.storage.sw_banners=t}}),r.React.createElement(w,{label:"Enable profile avatars",subLabel:"If enabled, profile avatars will load up.",leading:r.React.createElement(u.Icon,{source:v.getAssetIDByName("settings")}),value:o.storage.sw_avatars,onValueChange:function(t){return o.storage.sw_avatars=t}}),r.React.createElement(w,{label:"Enable custom badges",subLabel:"If enabled, custom badges will load up.",leading:r.React.createElement(u.Icon,{source:v.getAssetIDByName("settings")}),value:o.storage.sw_badges,onValueChange:function(t){return o.storage.sw_badges=t}})),r.React.createElement(S,{title:"Extras"},r.React.createElement(u,{label:"Discord Server",subLabel:"Join to Discord server for request profile avatar/banner/badge and choose decorations and effects.",leading:r.React.createElement(u.Icon,{source:v.getAssetIDByName("Discord")}),trailing:u.Arrow,onPress:function(){return r.url.openDeeplink("https://discord.gg/ffmkewQ4R7")}}),r.React.createElement(u,{label:"Refetch fakeProfile",leading:r.React.createElement(u.Icon,{source:v.getAssetIDByName("ic_message_retry")}),trailing:u.Arrow,onPress:async function(){return await _()?y.showToast("Refetched fakeProfile",v.getAssetIDByName("check")):y.showToast("Failed to refetch fakeProfile",v.getAssetIDByName("small"))}})))}const F=b.findByProps("default","getUserBannerURL"),T=b.findByStoreName("UserStore"),j=b.findByProps("getAvatarDecorationURL","default"),x=b.findByProps("isAnimatedAvatarDecoration"),z=b.findByName("ProfileBadges",!1),O=b.findByStoreName("UserProfileStore"),P=b.findByProps("getUserAvatarURL","getUserAvatarSource"),E="https://i.sampath.tech",H=E+"/v3/users/fakeProfile",W="100101099222222",q="100101099222224",K="v2.2",{View:$,Image:G,TouchableOpacity:J}=r.ReactNative,M=function(t){let{name:e,image:a,size:n,margin:i,custom:s}=t;const c=r.stylesheet.createThemedStyleSheet({container:{flexDirection:"row",alignItems:"center",flexWrap:"wrap",justifyContent:"flex-end"},img:{width:n,height:n,resizeMode:"contain",marginHorizontal:i}}),f=function(){return s||r.React.createElement(J,{onPress:function(){return y.showToast(e)}},r.React.createElement(G,{style:c.img,source:{uri:a}}))};return r.React.createElement($,{style:c.container},f())},{View:Q}=r.ReactNative;let l={},D={},g=[];const _=async function(){try{return D=await(await A.safeFetch(E+"/fakeProfile",{cache:"no-store"})).json(),l=await(await A.safeFetch(H,{cache:"no-store"})).json(),l}catch(t){N.logger.error("Failed to fetch fakeProfile data",t)}};function X(t){if(t==null)return null;const e=t.match(/\u{e005b}\u{e0023}([\u{e0061}-\u{e0066}\u{e0041}-\u{e0046}\u{e0030}-\u{e0039}]+?)\u{e002c}\u{e0023}([\u{e0061}-\u{e0066}\u{e0041}-\u{e0046}\u{e0030}-\u{e0039}]+?)\u{e005d}/u);if(e!=null){const a=[...e[0]].map(function(n){return String.fromCodePoint(n.codePointAt(0)-917504)}).join("");return a.substring(1,a.length-1).split(",").map(function(n){return parseInt(n.replace("#","0x"),16)})}else return null}const Y=async function(){if(await _(),!l)return y.showToast("Failed to load fakeProfile data.");if(D?.version!=K)return y.showToast("A new version of the fakeProfile plugin is available. Please update as soon as possible.");g.push(p.after("getUserProfile",O,function(t,e){var a;if(!e)return e;const n=X(e.bio);if(!((a=l[e.userId])===null||a===void 0)&&a.profile_effect&&o.storage.sw_effects){var i;e.profileEffectId=e.profileEffectID=(i=l[e.userId])===null||i===void 0?void 0:i.profile_effect,e.premiumType=2}return n&&o.storage.sw_themes&&(e.themeColors=n,e.premiumType=2),e})),g.push(p.after("getUserAvatarURL",P,function(t){let[{id:e},a]=t;var n;if(l[e]&&!((n=l[e])===null||n===void 0)&&n.avatar&&o.storage.sw_avatars)if(a){var i,s;return(s=l[e])===null||s===void 0||(i=s.avatar)===null||i===void 0?void 0:i.toString()}else{var c,f,d;const h=(d=new URL((f=l[e])===null||f===void 0||(c=f.avatar)===null||c===void 0?void 0:c.toString()).pathname.split("/").pop())===null||d===void 0?void 0:d.replace("a_","");return E+"/image/"+h}})),g.push(p.after("getUserAvatarSource",P,function(t,e){let[{id:a},n]=t;var i;if(l[a]&&!((i=l[a])===null||i===void 0)&&i.avatar&&o.storage.sw_avatars)if(n){var s,c;return(c=l[a])===null||c===void 0||(s=c.avatar)===null||s===void 0?void 0:s.toString()}else{var f,d,h;const R=(h=new URL((d=l[a])===null||d===void 0||(f=d.avatar)===null||f===void 0?void 0:f.toString()).pathname.split("/").pop())===null||h===void 0?void 0:h.replace("a_","");return E+"/image/"+R}})),g.push(p.after("getUserBannerURL",F,function(t){let[e]=t;const a=Object.entries(l).find(function(i){return i[0]===e?.id});if(e?.banner===void 0&&a&&o.storage.sw_banners){var n;return(n=l[e?.id])===null||n===void 0?void 0:n.banner}})),g.push(p.after("getUser",T,function(t,e){if(e&&l[e?.id]&&l[e?.id].decoration&&o.storage.sw_decorations){const a=l[e?.id];a?.decoration&&(e.avatarDecoration={asset:a.decoration.asset,skuId:a?.decoration.skuId}),e.avatarDecorationData=e.avatarDecoration}})),g.push(p.instead("getAvatarDecorationURL",j,function(t,e){const[{avatarDecoration:a,canAnimate:n}]=t;if(a?.skuId===q){const i=a.asset.split("_");return!n&&i[0]==="a"&&i.shift(),E+`/avatar-decoration-presets/${i.join("_")}.png`}else if(a?.skuId===W){const i=a.asset.split("_");return!n&&i[0]==="a"&&i.shift(),`https://cdn.discordapp.com/avatar-decoration-presets//${i.join("_")}.png`}else return e(...t)})),g.push(p.after("isAnimatedAvatarDecoration",x,function(t,e){let[a]=t;var n;if(r.ReactNative.Platform.OS==="ios"&&!(a==null||(n=a.asset)===null||n===void 0)&&n.startsWith("file://"))return!0})),g.push(p.after("default",z,function(t,e){var a,n,i;let s=e;const c=(a=t[0])===null||a===void 0?void 0:a.user,f=(n=l[c?.id])===null||n===void 0?void 0:n.badges;if(!c||!o.storage.sw_badges||!f)return;const d=s==null||(i=s.props)===null||i===void 0?void 0:i.style;s||(s=r.React.createElement(Q,{style:[d,{flexDirection:"row",flexWrap:"wrap",alignItems:"flex-end",justifyContent:"flex-end",paddingVertical:2}],accessibilityRole:"list",accessibilityLabel:"User Badges"}),s.props.children=[]);const h=function(R){let{name:te,image:ae,custom:re=!1}=R;var m;const B=function(){return r.React.createElement(M,{custom:re,name:te,image:ae,size:Array.isArray(d)?d?.find(function(L){return L.paddingVertical&&L.paddingHorizontal})?16:22:16,margin:Array.isArray(d)?4:6})};!(s==null||(m=s.props)===null||m===void 0)&&m.badges?s.props.badges=[r.React.createElement(B,null),...s.props.badges]:s.props.children=[r.React.createElement(B,null),...s.props.children]};f.map(function(R){h({name:R.description,image:R.icon})})})),setInterval(async function(){await _()},D?.reloadInterval)},Z=function(){return g.forEach(function(t){return t()})},ee=V;return I.fetchData=_,I.onLoad=Y,I.onUnload=Z,I.settings=ee,I})({},vendetta,vendetta.utils,vendetta.ui.toasts,vendetta.metro.common,vendetta.ui.components,vendetta.ui.assets,vendetta.metro,vendetta.patcher,vendetta.plugin,vendetta.storage);
