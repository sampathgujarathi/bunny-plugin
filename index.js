(function(h,L,_,p,a,m,u,v,g,o,N){"use strict";const{ScrollView:k}=m.General,{FormSection:U,FormRow:c,FormSwitchRow:b}=m.Forms;function C(){return N.useProxy(o.storage),a.React.createElement(k,null,a.React.createElement(U,{title:"Settings"},a.React.createElement(b,{label:"Enable profile effects",subLabel:"If enabled, profile effects will load up.",leading:a.React.createElement(c.Icon,{source:u.getAssetIDByName("settings")}),value:o.storage.sw_effects,onValueChange:function(t){return o.storage.sw_effects=t}}),a.React.createElement(b,{label:"Enable profile themes",subLabel:"If enabled, profile themes will load up.",leading:a.React.createElement(c.Icon,{source:u.getAssetIDByName("settings")}),value:o.storage.sw_themes,onValueChange:function(t){return o.storage.sw_themes=t}}),a.React.createElement(b,{label:"Enable profile avatar decoration",subLabel:"If enabled, profile avatar decoration will load up.",leading:a.React.createElement(c.Icon,{source:u.getAssetIDByName("settings")}),value:o.storage.sw_decorations,onValueChange:function(t){return o.storage.sw_decorations=t}}),a.React.createElement(b,{label:"Enable profile banners",subLabel:"If enabled, profile effects will load up.",leading:a.React.createElement(c.Icon,{source:u.getAssetIDByName("settings")}),value:o.storage.sw_banners,onValueChange:function(t){return o.storage.sw_banners=t}}),a.React.createElement(b,{label:"Enable profile avatars",subLabel:"If enabled, profile avatars will load up.",leading:a.React.createElement(c.Icon,{source:u.getAssetIDByName("settings")}),value:o.storage.sw_avatars,onValueChange:function(t){return o.storage.sw_avatars=t}}),a.React.createElement(b,{label:"Enable custom badges",subLabel:"If enabled, custom badges will load up.",leading:a.React.createElement(c.Icon,{source:u.getAssetIDByName("settings")}),value:o.storage.sw_badges,onValueChange:function(t){return o.storage.sw_badges=t}})),a.React.createElement(U,{title:"Extras"},a.React.createElement(c,{label:"Discord Server",subLabel:"Join to Discord server for request profile avatar/banner/badge and choose decorations and effects.",leading:a.React.createElement(c.Icon,{source:u.getAssetIDByName("Discord")}),trailing:c.Arrow,onPress:function(){return a.url.openDeeplink("https://discord.gg/ffmkewQ4R7")}}),a.React.createElement(c,{label:"Refetch fakeProfile",leading:a.React.createElement(c.Icon,{source:u.getAssetIDByName("ic_message_retry")}),trailing:c.Arrow,onPress:async function(){return await w()?p.showToast("Refetched fakeProfile",u.getAssetIDByName("check")):p.showToast("Failed to refetch fakeProfile",u.getAssetIDByName("small"))}})))}const V=v.findByProps("default","getUserBannerURL"),F=v.findByStoreName("UserStore"),T=v.findByProps("getAvatarDecorationURL","default"),j=v.findByProps("isAnimatedAvatarDecoration"),x=v.findByName("ProfileBadges",!1),z=v.findByStoreName("UserProfileStore"),B=v.findByProps("getUserAvatarURL","getUserAvatarSource"),E="https://i.sampath.tech",O=E+"/v3/users/fakeProfile",W="100101099222222",H="100101099222224",$="v2.17",{View:K,Image:q,TouchableOpacity:G}=a.ReactNative,J=function(t){let{name:e,image:r,size:n,margin:s,custom:i}=t;const d=a.stylesheet.createThemedStyleSheet({container:{flexDirection:"row",alignItems:"center",flexWrap:"wrap",justifyContent:"flex-end"},img:{width:n,height:n,resizeMode:"contain",marginHorizontal:s}}),R=function(){return i||a.React.createElement(G,{onPress:function(){return p.showToast(e)}},a.React.createElement(q,{style:d.img,source:{uri:r}}))};return a.React.createElement(K,{style:d.container},R())},{View:M}=a.ReactNative;let l={},D={},f=[];const w=async function(){try{return D=await(await _.safeFetch(E+"/fakeProfile",{cache:"no-store"})).json(),l=await(await _.safeFetch(O,{cache:"no-store"})).json(),l}catch(t){L.logger.error("Failed to fetch fakeProfile data",t)}};function Q(t){if(t==null)return null;const e=t.match(/\u{e005b}\u{e0023}([\u{e0061}-\u{e0066}\u{e0041}-\u{e0046}\u{e0030}-\u{e0039}]+?)\u{e002c}\u{e0023}([\u{e0061}-\u{e0066}\u{e0041}-\u{e0046}\u{e0030}-\u{e0039}]+?)\u{e005d}/u);if(e!=null){const r=[...e[0]].map(function(n){return String.fromCodePoint(n.codePointAt(0)-917504)}).join("");return r.substring(1,r.length-1).split(",").map(function(n){return parseInt(n.replace("#","0x"),16)})}else return null}const X=async function(){if(await w(),!l)return p.showToast("Failed to load fakeProfile data.");if(D?.version!=$)return p.showToast("A new version of the fakeProfile plugin is available. Please update as soon as possible.");f.push(g.after("getUserProfile",z,function(t,e){var r;if(!e)return e;const n=Q(e.bio);if(!((r=l[e.userId])===null||r===void 0)&&r.profile_effect&&o.storage.sw_effects){var s;e.profileEffectId=e.profileEffectID=(s=l[e.userId])===null||s===void 0?void 0:s.profile_effect,e.premiumType=2}return n&&o.storage.sw_themes&&(e.themeColors=n,e.premiumType=2),e})),f.push(g.after("getUserAvatarURL",B,function(t){let[{id:e},r]=t;var n,s,i;if(l[e]&&!((n=l[e])===null||n===void 0)&&n.avatar&&o.storage.sw_avatars)return(i=l[e])===null||i===void 0||(s=i.avatar)===null||s===void 0?void 0:s.toString()})),f.push(g.after("getUserAvatarSource",B,function(t,e){let[{id:r},n]=t;var s;if(l[r]&&!((s=l[r])===null||s===void 0)&&s.avatar&&o.storage.sw_avatars){var i,d;return{uri:(d=l[r])===null||d===void 0||(i=d.avatar)===null||i===void 0?void 0:i.toString()}}})),f.push(g.after("getUserBannerURL",V,function(t){let[e]=t;const r=Object.entries(l).find(function(s){return s[0]===e?.id});if(e?.banner===void 0&&r&&o.storage.sw_banners){var n;return(n=l[e?.id])===null||n===void 0?void 0:n.banner}})),f.push(g.after("getUser",F,function(t,e){if(e&&l[e?.id]&&l[e?.id].decoration&&o.storage.sw_decorations){const r=l[e?.id];r?.decoration&&(e.avatarDecoration={asset:r.decoration.asset,skuId:r?.decoration.skuId}),e.avatarDecorationData=e.avatarDecoration}})),f.push(g.instead("getAvatarDecorationURL",T,function(t,e){const[{avatarDecoration:r,canAnimate:n}]=t;if(r?.skuId===H){const s=r.asset.split("_");return!n&&s[0]==="a"&&s.shift(),E+`/avatar-decoration-presets/${s.join("_")}.png`}else if(r?.skuId===W){const s=r.asset.split("_");return!n&&s[0]==="a"&&s.shift(),`https://cdn.discordapp.com/avatar-decoration-presets//${s.join("_")}.png`}else return e(...t)})),f.push(g.after("isAnimatedAvatarDecoration",j,function(t,e){let[r]=t;var n;if(a.ReactNative.Platform.OS==="ios"&&!(r==null||(n=r.asset)===null||n===void 0)&&n.startsWith("file://"))return!0})),f.push(g.after("default",x,function(t,e){var r,n,s;let i=e;const d=(r=t[0])===null||r===void 0?void 0:r.user,R=(n=l[d?.id])===null||n===void 0?void 0:n.badges;if(!d||!o.storage.sw_badges||!R)return;const I=i==null||(s=i.props)===null||s===void 0?void 0:s.style;i||(i=a.React.createElement(M,{style:[I,{flexDirection:"row",flexWrap:"wrap",alignItems:"flex-end",justifyContent:"flex-end",paddingVertical:2}],accessibilityRole:"list",accessibilityLabel:"User Badges"}),i.props.children=[]);const ee=function(y){let{name:te,image:ae,custom:re=!1}=y;var A;const P=function(){return a.React.createElement(J,{custom:re,name:te,image:ae,size:Array.isArray(I)?I?.find(function(S){return S.paddingVertical&&S.paddingHorizontal})?16:22:16,margin:Array.isArray(I)?4:6})};!(i==null||(A=i.props)===null||A===void 0)&&A.badges?i.props.badges=[a.React.createElement(P,null),...i.props.badges]:i.props.children=[a.React.createElement(P,null),...i.props.children]};R.map(function(y){ee({name:y.description,image:y.icon})})})),setInterval(async function(){await w()},D?.reloadInterval)},Y=function(){return f.forEach(function(t){return t()})},Z=C;return h.fetchData=w,h.onLoad=X,h.onUnload=Y,h.settings=Z,h})({},vendetta,vendetta.utils,vendetta.ui.toasts,vendetta.metro.common,vendetta.ui.components,vendetta.ui.assets,vendetta.metro,vendetta.patcher,vendetta.plugin,vendetta.storage);
